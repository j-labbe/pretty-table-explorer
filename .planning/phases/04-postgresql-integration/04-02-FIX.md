---
phase: 04-postgresql-integration
plan: 04-02-FIX
type: fix
---

<objective>
Fix 1 UAT issue from plan 04-02.

Source: 04-02-ISSUES.md
Priority: 0 critical, 0 major, 1 minor
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Issues being fixed:**
@.planning/phases/04-postgresql-integration/04-02-ISSUES.md

**Original plan for reference:**
@.planning/phases/04-postgresql-integration/04-02-PLAN.md

**Current implementation:**
@src/main.rs
</context>

<tasks>
<task type="auto">
  <name>Fix UAT-001: Error messages disappear too quickly</name>
  <files>src/main.rs</files>
  <action>
Add timed status message persistence:

1. Add `use std::time::Instant;` at top of file (if not already present)

2. Add a new field alongside `status_message`:
   ```rust
   let mut status_message_time: Option<Instant> = None;
   ```

3. When setting status_message, also set the timestamp:
   - Find all places where `status_message = Some(...)` is set
   - After each, add: `status_message_time = Some(Instant::now());`

4. Modify the status message clearing logic (currently at line ~384):
   - Instead of unconditionally clearing: `status_message = None;`
   - Check if 3 seconds have elapsed:
   ```rust
   if let Some(msg_time) = status_message_time {
       if msg_time.elapsed().as_secs() >= 3 {
           status_message = None;
           status_message_time = None;
       }
   }
   ```

This ensures error messages remain visible for 3 seconds, giving users time to read them.
  </action>
  <verify>
1. cargo build succeeds
2. Run with database connection
3. Enter invalid query (`:SELECT * FROM nonexistent_xyz`)
4. Error message should remain visible for ~3 seconds before disappearing
  </verify>
  <done>Error messages persist for 3 seconds before auto-clearing</done>
</task>
</tasks>

<verification>
Before declaring plan complete:
- [ ] cargo build succeeds without errors
- [ ] Error messages remain visible for ~3 seconds
- [ ] Normal operation unaffected (navigation, filtering, queries)
- [ ] Status messages still clear after timeout
</verification>

<success_criteria>
- UAT-001 resolved: Error messages visible long enough to read
- No regressions in existing functionality
- Ready for re-verification
</success_criteria>

<output>
After completion, create `.planning/phases/04-postgresql-integration/04-02-FIX-SUMMARY.md`
</output>
