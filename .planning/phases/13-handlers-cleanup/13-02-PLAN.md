---
phase: 13-handlers-cleanup
plan: 02
type: execute
depends_on: ["13-01"]
files_modified: [src/render.rs, src/workspace.rs]
---

<objective>
Fix clippy warnings and remove dead code identified during the refactoring process.

Purpose: Clean codebase with zero warnings, no unused code.
Output: All clippy warnings fixed, dead code removed.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-handlers-cleanup/13-01-SUMMARY.md
@src/render.rs
@src/workspace.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix cumulative_width warnings in render.rs</name>
  <files>src/render.rs</files>
  <action>Fix the 4 "value assigned to cumulative_width is never read" warnings in render.rs.

The warnings are at lines 167, 178, 214, 223. These are cases where cumulative_width is assigned but then immediately reassigned or the value is never used after the block.

Look at the loop logic in calculate_visible_columns_with_indicators function:
- The cumulative_width variable is used to track how much width has been consumed
- At certain points it's assigned but then the loop continues or breaks without using that value
- Either remove the unnecessary assignments or restructure the loop to avoid them

Options:
1. Remove assignments that happen right before break/continue/end of loop iteration
2. Use `_cumulative_width` if the value genuinely isn't needed but the calculation is for clarity
3. Restructure to avoid the warnings while maintaining correctness

Choose the cleanest solution that maintains the function's correctness. The scroll indicator logic is sensitive, so verify the output is still correct after changes.</action>
  <verify>cargo clippy shows no warnings for render.rs, cargo test passes</verify>
  <done>All cumulative_width warnings fixed in render.rs</done>
</task>

<task type="auto">
  <name>Task 2: Remove or use dead code in workspace.rs</name>
  <files>src/workspace.rs</files>
  <action>Address the dead code warnings for methods in workspace.rs:
- `active_tab` (line 94)
- `tab_names` (line 179)
- `focused_tab` (line 203)

For each method:
1. Check if it's used anywhere in the codebase (grep for usage)
2. If not used, remove it
3. If intended for future use, add `#[allow(dead_code)]` with a comment explaining why

Based on Phase 11-12 summaries, these were likely helper methods that became unused after refactoring. If they're not used, remove them to keep the codebase clean.

Commands to check usage:
```bash
grep -r "active_tab" src/
grep -r "tab_names" src/
grep -r "focused_tab" src/
```

Note: `focused_tab_mut` is used (mutable version), but `focused_tab` (immutable) may not be.</action>
  <verify>cargo clippy shows no dead_code warnings for workspace.rs</verify>
  <done>Dead code warnings resolved in workspace.rs</done>
</task>

<task type="auto">
  <name>Task 3: Final verification and cleanup</name>
  <files>src/*.rs</files>
  <action>Run full verification:
1. cargo build --release
2. cargo test
3. cargo clippy -- -D warnings (fail on any warning)
4. Check total line count: wc -l src/*.rs

Document:
- Final line counts per file
- Any remaining warnings (should be none)
- Total codebase size after refactoring</action>
  <verify>cargo clippy -- -D warnings passes with no warnings</verify>
  <done>Codebase compiles warning-free, all tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build` succeeds without errors
- [ ] `cargo test` passes all tests
- [ ] `cargo clippy -- -D warnings` passes with no warnings
- [ ] No dead code warnings
- [ ] No unused assignment warnings
</verification>

<success_criteria>

- All tasks completed
- Zero clippy warnings
- All tests pass
- Phase 13 complete
</success_criteria>

<output>
After completion, create `.planning/phases/13-handlers-cleanup/13-02-SUMMARY.md`:

# Phase 13 Plan 02: Clippy Fixes and Dead Code Removal Summary

**[Substantive one-liner]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `src/render.rs` - Description
- `src/workspace.rs` - Description

## Task Commits

| Task | Commit | Description |
|------|--------|-------------|
| Task 1 | hash | description |
| Task 2 | hash | description |
| Task 3 | (none) | Verification - no commit needed |

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 13 complete. v1.3 Code Quality milestone finished.
</output>
